title User Cancel Ticket Sequence Diagram (Exceeds Cancellation Deadline)

actor User
boundary TicketSystem
control TicketService
entity Ticket
entity Event

note right of User: The user selects 'Cancel' option for a ticket on their ticket list page (40-view_purchased_tickets.png).
User ->> TicketSystem : initiateTicketCancellation(eventName: String)

activate TicketSystem
note right of TicketSystem: The system asks the user to confirm cancellation.
TicketSystem ->> User : requestCancellationConfirmation

note right of User: The user selects **Yes** to confirm the cancellation.
User ->> TicketSystem : confirmCancellation

note right of TicketSystem: The system forwards the cancellation request to the TicketService.
TicketSystem ->> TicketService : cancelTicket(userEmail: String, eventName: String)
activate TicketService

note right of TicketService: The service checks if the cancellation is within the allowed time frame.
TicketService ->> Event : checkCancellationTime(eventName: String)
activate Event
Event --> TicketService : return isCancellable = false
deactivate Event

alt isCancellable == false
    note right of TicketService: Cancellation is not allowed as the deadline has passed.
    TicketService -->> TicketSystem : return cancellationFailed(exceedsDeadline)
end

deactivate TicketService

note right of TicketSystem: The system displays a message indicating that the ticket cannot be cancelled due to exceeding the deadline.
TicketSystem -->> User : displayCancellationDeadlineExceededMessage

deactivate TicketSystem
